(function(t){function e(e){for(var n,s,o=e[0],r=e[1],c=e[2],d=0,f=[];d<o.length;d++)s=o[d],Object.prototype.hasOwnProperty.call(l,s)&&l[s]&&f.push(l[s][0]),l[s]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);h&&h(e);while(f.length)f.shift()();return a.push.apply(a,c||[]),i()}function i(){for(var t,e=0;e<a.length;e++){for(var i=a[e],n=!0,o=1;o<i.length;o++){var r=i[o];0!==l[r]&&(n=!1)}n&&(a.splice(e--,1),t=s(s.s=i[0]))}return t}var n={},l={app:0},a=[];function s(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=n,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],r=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var h=r;a.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"21bb":function(t,e,i){"use strict";var n=i("2dad"),l=i.n(n);l.a},"2dad":function(t,e,i){},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("router-view")],1)},a=[],s=(i("5c0b"),i("2877")),o={},r=Object(s["a"])(o,l,a,!1,null,null,null),c=r.exports,h=i("8c4f"),d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"home",staticClass:"home"},[i("div",{staticClass:"header"},[t._m(0),i("div",{staticClass:"cellVal"},[i("div",{staticClass:"cell"},[t._v(t._s(t.clickCellInfo.position))]),i("div",{staticClass:"val"},[t._v(t._s(t.clickCellInfo.txt))])])]),i("div",{staticClass:"main"},[i("div",{staticClass:"allSelect",style:{width:t.numCellWidth+.5+"px",height:t.cellHeight+.5+"px"}}),i("div",{ref:"top",staticClass:"top",style:{height:t.topCanvas.canvasHeight+"px"}},[i("canvas",{ref:"topCanvas",staticClass:"topCanvas",style:{width:t.topCanvas.canvasWidth+"px",height:t.topCanvas.canvasHeight+"px",left:t.scrollBar.x+"px"},attrs:{width:t.topCanvas.canvasWidth*t.ratio,height:t.topCanvas.canvasHeight*t.ratio}})]),i("div",{ref:"left",staticClass:"left",style:{width:t.numCellWidth+1+"px",top:t.cellHeight+"px"}},[i("canvas",{ref:"leftCanvas",staticClass:"leftCanvas",style:{width:t.leftCanvas.canvasWidth+"px",height:t.leftCanvas.canvasHeight+"px",top:t.scrollBar.y+"px"},attrs:{width:t.leftCanvas.canvasWidth*t.ratio,height:t.leftCanvas.canvasHeight*t.ratio}})]),i("div",{ref:"center",staticClass:"center",style:{top:t.cellHeight+"px",left:t.numCellWidth+"px"}},[i("canvas",{ref:"centerCanvas",staticClass:"centerCanvas",style:{width:t.centerCanvas.canvasWidth+"px",height:t.centerCanvas.canvasHeight+"px",top:t.scrollBar.y+"px",left:t.scrollBar.x+"px"},attrs:{width:t.centerCanvas.canvasWidth*t.ratio,height:t.centerCanvas.canvasHeight*t.ratio}}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.clickCell.show,expression:"clickCell.show"}],staticClass:"clickCell",style:{width:t.cellWidth+.5+"px",height:t.cellHeight+.5+"px",left:t.clickCell.x+"px",top:t.clickCell.y+"px"}},[t.cellIpt?i("div",{ref:"cellIpt",staticClass:"cellIpt",attrs:{contenteditable:""},on:{mousedown:function(t){t.preventDefault(),t.stopPropagation()},dblclick:function(t){t.preventDefault(),t.stopPropagation()},blur:t.handlerCellIptBlur,input:t.handlerCellIptIput}}):t._e()]),i("div",{ref:"rightSideBar",staticClass:"rightSideBar"},[i("div",{staticClass:"scrollBar",style:{top:t.rightScrollBar.top+"px",height:t.rightScrollBar.height+"px",opacity:t.scrollBarOpacity},on:{mousedown:function(e){return t.handlerScrollBarDragMove(e,!0)}}})]),i("div",{ref:"bottomScrollBar",staticClass:"bottomScrollBar"},[i("div",{staticClass:"scrollBar",style:{left:t.bottomScrollBar.left+"px",width:t.bottomScrollBar.width+"px",opacity:t.scrollBarOpacity},on:{mousedown:function(e){return t.handlerScrollBarDragMove(e,!1)}}})])])])])},f=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"toolBar"},[i("div",{staticClass:"firstPart"},[i("i",{staticClass:"iconfont icon-save"}),i("i",{staticClass:"iconfont icon-undo"}),i("i",{staticClass:"iconfont icon-redo"}),i("i",{staticClass:"iconfont icon-formatpainter-fill"}),i("i",{staticClass:"iconfont icon-clear"})]),i("div",{staticClass:"secondPart"},[i("i",{staticClass:"iconfont icon-bold"}),i("i",{staticClass:"iconfont icon-strikethrough"}),i("i",{staticClass:"iconfont icon-underline"}),i("i",{staticClass:"iconfont icon-italic"}),i("i",{staticClass:"iconfont icon-font-colors"}),i("i",{staticClass:"iconfont icon-bg-colors"})]),i("div",{staticClass:"thirdPart"},[i("i",{staticClass:"iconfont icon-align-left"}),i("i",{staticClass:"iconfont icon-align-center"}),i("i",{staticClass:"iconfont icon-align-right"}),i("i",{staticClass:"iconfont icon-merge-cells"}),i("i",{staticClass:"iconfont icon-solit-cells"}),i("i",{staticClass:"iconfont icon-gongshi"})])])}],p=(i("99af"),i("cb29"),i("4160"),i("d3b7"),i("25f0"),i("159b"),i("2909")),u={name:"Home",data:function(){return{ratio:window.devicePixelRatio,topCanvas:{canvasWidth:0,canvasHeight:0,ctx:null},leftCanvas:{canvasWidth:0,canvasHeight:0,ctx:null},centerCanvas:{canvasWidth:0,canvasHeight:0,ctx:null},cellWidth:120,cellHeight:25,wordsHead:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],numCellWidth:40,scrollBar:{x:0,y:0},rightScrollBar:{top:0,height:(window.innerHeight-60-25)/2500*(window.innerHeight-60-25)},bottomScrollBar:{left:0,width:(window.innerWidth-40)/3120*(window.innerWidth-40)},scrollBarMousedownPosition:{},scrollBarOpacity:0,scrollBarTimer:null,centerCells:[],letfCells:[],headCells:[],clickCell:{x:0,y:0,show:!1},clickCellInfo:{x:0,y:0,position:"",xNum:0,yNum:0,width:0,height:0,txt:""},dbClickCellInfo:{x:0,y:0,position:"",xNum:0,yNum:0,width:0,height:0,txt:""},mousedownXY:{x:0,y:0},cellIpt:!1}},computed:{copyClickCellInfo:function(){return JSON.parse(JSON.stringify(this.clickCellInfo))},centerHeight:function(){return window.innerHeight-60-25},centerWidth:function(){return window.innerWidth-this.numCellWidth}},methods:{init:function(){this.handlerDrawHead(),this.handlerDrawLeft(),this.handlerDrawCenter(),this.handlerDomResize(),this.handlerDomAddEvents()},handlerCellIptBlur:function(t){var e=this.centerCells,i=this.centerCanvas.ctx,n=this.dbClickCellInfo,l=n.xNum,a=n.yNum,s=n.x,o=n.y,r=n.width,c=n.height,h=this.cellWidth,d=this.cellHeight,f=(this.handlerPointAddFixed,this.handlerClearRect),p=this.handlerPointRect,u=(this.ratio,t.target.innerHTML);i.fillStyle="rgb(38, 38, 38);",u===e[a][l].txt||(e[a][l].txt=u,f(i,s,o,h,d),p(i,s,o,r,c,"",null,"rgb(38, 38, 38)"),this.handlerDrawTxt(i,s,o,r,c,u)),t.target.innerHTML=""},handlerCellIptIput:function(t){this.clickCellInfo.txt+=t.data},handlerClearRect:function(t,e,i,n,l){var a=this.handlerPointAddFixed;t.clearRect.apply(t,Object(p["a"])(a(e+1,i+1)).concat(Object(p["a"])(a(n,l)))),t.clearRect.apply(t,Object(p["a"])(a(e,i)).concat(Object(p["a"])(a(n,l))))},handlerCenterCanvasMousedown:function(t){this.handlerCenterClick(t),t.preventDefault(),this.mousedownXY={x:t.clientX,y:t.clientY},window.addEventListener("mousemove",this.handlerCanvasMousemove)},handlerCenterCanvasMouseup:function(t){return t.preventDefault(),window.removeEventListener("mousemove",this.handlerCanvasMousemove),!1},handlerCanvasMousemove:function(t){var e=this.clickCell,i=e.x,n=e.y,l=this.numCellWidth,a=this.scrollBar,s=this.cellHeight,o=this.cellWidth,r={},c=t.clientX,h=t.clientY;r.x=c-l-a.x,r.y=h-60-s-a.y,r.x-i>o&&console.log("x"),r.y-n>s&&console.log("y")},handlerDbClick:function(){var t=this;this.cellIpt=!0;var e=this.centerCells,i=this.clickCellInfo,n=i.xNum,l=i.yNum;this.dbClickCellInfo=Object.assign({},this.clickCellInfo);var a=window.getSelection();this.$nextTick((function(){t.$refs.cellIpt.focus(),t.$refs.cellIpt.innerHTML=e[l][n].txt,a.selectAllChildren(t.$refs.cellIpt),a.collapseToEnd()}))},handlerCenterClick:function(t){var e=this.cellWidth,i=this.cellHeight,n=this.clickCell,l=this.clickCellInfo,a=this.scrollBar,s=this.cellIpt,o=this.centerCells,r=this.numCellWidth;s&&(this.cellIpt=!1);var c=t.clientX,h=t.clientY,d=c-r-a.x,f=h-60-i-a.y;n.x=Math.floor(d/e)*e+a.x,l.x=Math.floor(d/e)*e,n.y=Math.floor(f/i)*i+a.y,l.y=Math.floor(f/i)*i,n.show=!0,l.position="".concat(this.wordsHead[Math.floor(d/e)]).concat(Math.floor(f/i)+1),l.xNum=Math.floor(d/e),l.yNum=Math.floor(f/i),l.width=e,l.height=i,l.txt=o[l.yNum][l.xNum].txt},handlerDomAddEvents:function(){var t=this;window.addEventListener("mousewheel",(function(e){t.handlerWheel(e)}),{passive:!1}),this.$refs.center.addEventListener("dblclick",this.handlerDbClick,!1),this.$refs.center.addEventListener("mousedown",this.handlerCenterCanvasMousedown,!1),this.$refs.center.addEventListener("mouseup",this.handlerCenterCanvasMouseup,!1)},handlerWheel:function(t){var e=this;t.preventDefault(),t.returnValue=!1;var i=this.handlerScrollX,n=this.handlerScrollY;this.scrollBarOpacity=1,window.clearTimeout(this.scrollBarTimer),this.scrollBarTimer=window.setTimeout((function(){e.scrollBarOpacity=0}),2e3);var l=t.deltaX,a=t.deltaY;this.$nextTick((function(){Math.abs(l)>Math.abs(a)?i(l):n(a)}))},handlerScrollX:function(t){var e=this.scrollBar,i=this.topCanvas,n=this.clickCell,l=this.clickCellInfo,a=this.bottomScrollBar,s=this.centerWidth;e.x=e.x-t,a.left+=t/3120*s,-e.x+parseInt(this.$refs.top.style.width)>=i.canvasWidth?(e.x=-(i.canvasWidth-parseInt(this.$refs.top.style.width)),a.left=s-a.width):e.x>=0&&(e.x=0,a.left=0),n.show&&(n.x=l.x+e.x)},handlerScrollY:function(t){var e=this.scrollBar,i=this.leftCanvas,n=this.clickCell,l=this.clickCellInfo,a=this.rightScrollBar,s=this.centerHeight;e.y-=t,a.top+=t/2500*(s-3),-e.y+parseInt(this.$refs.left.style.height)>=i.canvasHeight?(e.y=-(i.canvasHeight-parseInt(this.$refs.left.style.height)),a.top=s-3-a.height):e.y>=0&&(e.y=a.top=0),n.show&&(n.y=l.y+e.y)},handlerScrollBarDragMove:function(t,e){var i=this;this.scrollBarMousedownPosition={x:t.clientX,y:t.clientY,type:e},this.scrollBarOpacity=1,window.clearTimeout(this.scrollBarTimer),document.addEventListener("mousemove",this.handlerMoveWidth),document.addEventListener("mouseup",(function(){document.removeEventListener("mousemove",i.handlerMoveWidth),i.scrollBarTimer=window.setTimeout((function(){i.scrollBarOpacity=0}),2e3)}))},handlerMoveWidth:function(t){var e=this.scrollBarMousedownPosition,i=this.rightScrollBar,n=this.bottomScrollBar,l=this.centerHeight,a=this.scrollBar,s=this.leftCanvas,o=this.centerWidth,r=this.topCanvas,c=this.cellWidth,h=this.wordsHead;if(e.type){var d=t.clientY-e.y;e.y=t.clientY,i.top+=d,a.y-=d/(l-3)*2500,i.top>=l-3-i.height?(i.top=l-3-i.height,a.y=-(s.canvasHeight-parseInt(this.$refs.left.style.height))):i.top<=0&&(a.y=i.top=0)}else{var f=t.clientX-e.x;e.x=t.clientX,n.left+=f,a.x-=f/o*c*h.length,n.left<=0?a.x=n.left=0:n.left>=o-n.width&&(n.left=o-n.width,a.x=-(r.canvasWidth-parseInt(this.$refs.top.style.width)))}},handlerDomResize:function(){this.$refs.left.style.height=window.innerHeight-60-26+"px",this.$refs.center.style.height=window.innerHeight-60-26+"px",this.$refs.top.style.width=window.innerWidth-this.numCellWidth+"px",this.$refs.center.style.width=window.innerWidth-this.numCellWidth+"px"},handlerDrawHead:function(){var t=this,e=this.cellWidth,i=this.cellHeight,n=this.topCanvas,l=this.wordsHead,a=this.headCells,s=this.handlerPointRect,o=this.$refs.topCanvas.getContext("2d");n.ctx=o;for(var r=0;r<l.length;r++){var c={x:r*e,y:0,width:e,height:i,txt:l[r]};a.push(c)}n.canvasWidth=l.length*e+e/2,n.canvasHeight=i+1,this.$nextTick((function(){o.lineWidth=1*t.ratio,o.strokeStyle="#cecece",o.font="normal ".concat(12*t.ratio,"px PingFang SC"),o.textAlign="center",o.textBaseline="middle",a.forEach((function(t){var e=t.x,i=t.y,n=t.width,l=t.height,a=t.txt;s(o,e,i,n,l,a,"#fafafa")}))}))},handlerDrawCenter:function(){var t=this,e=this.centerCanvas,i=this.centerCells,n=this.wordsHead,l=this.cellWidth,a=this.cellHeight,s=this.handlerPointRect,o=this.$refs.centerCanvas.getContext("2d");e.ctx=o,e.canvasHeight=100*a+1,e.canvasWidth=n.length*l+l/2;for(var r=0;r<100;r++){for(var c=[],h=0;h<n.length;h++){var d={x:h*l,y:r*a,width:l,height:a,txt:""};c.push(d)}i.push(c)}this.$nextTick((function(){o.lineWidth=1*t.ratio,o.strokeStyle="#cecece",o.font="normal ".concat(12*t.ratio,"px PingFang SC"),o.textAlign="center",o.textBaseline="middle",i.forEach((function(t){t.forEach((function(t){var e=t.x,i=t.y,n=t.width,l=t.height,a=t.txt;s(o,e,i,n,l,a,null,"rgb(38, 38, 38)")}))}))}))},handlerDrawLeft:function(){var t=this,e=this.numCellWidth,i=this.cellHeight,n=this.leftCanvas,l=this.letfCells,a=this.handlerPointRect,s=this.$refs.leftCanvas.getContext("2d");n.ctx=s;for(var o=1;o<=100;o++){var r={x:0,y:(o-1)*i,width:e,height:i,txt:o};l.push(r)}n.canvasWidth=e+1,n.canvasHeight=l.length*i+1,this.$nextTick((function(){s.lineWidth=1*t.ratio,s.strokeStyle="#cecece",s.font="normal ".concat(12*t.ratio,"px PingFang SC"),s.textAlign="center",s.textBaseline="middle",l.forEach((function(t){var e=t.x,i=t.y,n=t.width,l=t.height,o=t.txt;a(s,e,i,n,l,o,"#fafafa")}))}))},handlerLineAddFixed:function(t,e){return[(t+.5)*this.ratio,(e+.5)*this.ratio]},handlerPointAddFixed:function(t,e){return[t*this.ratio,e*this.ratio]},handlerPointRect:function(t,e,i,n,l,a,s,o){t.fillStyle=s||"#fff",t.beginPath(),t.moveTo.apply(t,Object(p["a"])(this.handlerLineAddFixed(e,i))),t.lineTo.apply(t,Object(p["a"])(this.handlerLineAddFixed(e+n,i))),t.lineTo.apply(t,Object(p["a"])(this.handlerLineAddFixed(e+n,i+l))),t.lineTo.apply(t,Object(p["a"])(this.handlerLineAddFixed(e,i+l))),t.lineTo.apply(t,Object(p["a"])(this.handlerLineAddFixed(e,i))),t.fill(),t.closePath(),t.stroke(),t.fillStyle=o||"#000",a.toString().length>0&&t.fillText.apply(t,[a].concat(Object(p["a"])(this.handlerPointAddFixed(e+n/2,i+l/2))))},handlerPointHalfRect:function(t,e,i,n,l){t.strokeStyle="#cecece",t.beginPath(),t.moveTo.apply(t,Object(p["a"])(this.handlerLineAddFixed(e,i))),t.lineTo.apply(t,Object(p["a"])(this.handlerLineAddFixed(e+n,i))),t.moveTo.apply(t,Object(p["a"])(this.handlerLineAddFixed(e,i))),t.lineTo.apply(t,Object(p["a"])(this.handlerLineAddFixed(e,i+l))),t.closePath(),t.stroke()},handlerDrawBorder:function(t,e,i,n,l){t.strokeStyle="#2a83fa",t.beginPath(),t.moveTo.apply(t,Object(p["a"])(this.handlerLineAddFixed(e,i))),t.lineTo.apply(t,Object(p["a"])(this.handlerLineAddFixed(n,l))),t.closePath(),t.stroke(),t.strokeStyle="#cecece"},handlerDrawTxt:function(t,e,i,n,l,a){var s=this.cellWidth,o=this.ratio;t.textAlign="left",t.fillText.apply(t,[a].concat(Object(p["a"])(this.handlerPointAddFixed(e+5,i+l/2)),[(s-5)*o]))},handlerDrawClickRowCol:function(t){var e=t.x,i=t.y,n=t.width,l=t.height,a=t.xNum,s=t.yNum,o=this.leftCanvas,r=this.topCanvas,c=(this.handlerPointAddFixed,this.handlerClearRect),h=this.numCellWidth,d=this.handlerPointRect,f=this.handlerDrawBorder,p=this.wordsHead,u=[0,i],v=[e,0];c.apply(void 0,[o.ctx].concat(u,[h,l])),c.apply(void 0,[r.ctx].concat(v,[n,l])),d.apply(void 0,[o.ctx].concat(u,[h,l,s+1,"#E6E6E6"])),f(o.ctx,h,i,h,i+l),d.apply(void 0,[r.ctx].concat(v,[n,l,p[a],"#E6E6E6"])),f(r.ctx,e,l,e+n,l)},handlerClearOldClickRowCol:function(t,e,i){var n=t.x,l=t.y,a=t.width,s=t.height,o=t.xNum,r=t.yNum,c=this.leftCanvas,h=this.topCanvas,d=(this.handlerPointAddFixed,this.handlerClearRect),f=this.numCellWidth,p=this.handlerPointRect,u=this.wordsHead,v=[0,l],C=[n,0];e&&i?(d.apply(void 0,[c.ctx].concat(v,[f,s])),d.apply(void 0,[h.ctx].concat(C,[a,s])),p.apply(void 0,[c.ctx].concat(v,[f,s,r+1,"#fafafa"])),p.apply(void 0,[h.ctx].concat(C,[a,s,u[o],"#fafafa"]))):e&&!i?(d.apply(void 0,[c.ctx].concat(v,[f,s])),p.apply(void 0,[c.ctx].concat(v,[f,s,r+1,"#fafafa"]))):!e&&i&&(d.apply(void 0,[h.ctx].concat(C,[a,s])),p.apply(void 0,[h.ctx].concat(C,[a,s,u[o],"#fafafa"])))}},watch:{copyClickCellInfo:{handler:function(t,e){this.handlerDrawClickRowCol(t),e.position&&(t.x!=e.x&&t.y!=e.y?this.handlerClearOldClickRowCol(e,!0,!0):t.x==e.x&&t.y!=e.y?this.handlerClearOldClickRowCol(e,!0):t.x!=e.x&&t.y==e.y&&this.handlerClearOldClickRowCol(e,null,!0))},deep:!0}},mounted:function(){this.init()}},v=u,C=(i("21bb"),Object(s["a"])(v,d,f,!1,null,null,null)),x=C.exports;n["a"].use(h["a"]);var y=[{path:"/",name:"Home",component:x}],g=new h["a"]({base:"",routes:y}),w=g,m=i("2f62");n["a"].use(m["a"]);var b=new m["a"].Store({state:{},mutations:{},actions:{},modules:{}});i("99bf"),i("ed2c");n["a"].config.productionTip=!1,new n["a"]({router:w,store:b,render:function(t){return t(c)}}).$mount("#app")},"5c0b":function(t,e,i){"use strict";var n=i("9c0c"),l=i.n(n);l.a},"99bf":function(t,e,i){},"9c0c":function(t,e,i){},ed2c:function(t,e,i){}});